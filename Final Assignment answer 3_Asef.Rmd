---
title: "Final assignment answer 3_Asef"
author: "Asef Jawad Niloy"
date: "2023-12-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.



```{r}
install.packages("data.table")
library(data.table)
```




```{r}
file_path <- "/home/cb2user/Downloads/Final assignment/Homo_sapiens.gene_info/Homo_sapiens.gene_info"
```



```{r}
install.packages("ggplot2")
```


```{r}
library(ggplot2)
```




```{r}
#a
file_path <- "/home/cb2user/Downloads/Final assignment/Homo_sapiens.gene_info"
gene_info <- read.delim(file_path)
gene_info_subset <- gene_info[, c("Symbol", "chromosome")]
head(gene_info_subset)
gene_info_clean <- gene_info_subset[!grepl("\\|", gene_info_subset$chromosome), ]
gene_info_clean$chromosome <- factor(gene_info_clean$chromosome,
                                     levels = c(as.character(1:22), "X", "Y"))
chromosome_counts <- table(gene_info_clean$chromosome)
chromosome_data <- data.frame(Chromosome = names(chromosome_counts),
                              Gene_Count = as.numeric(chromosome_counts))
ggplot(chromosome_data, aes(x = Chromosome, y = Gene_Count)) +
  geom_bar(stat = "identity", fill = "grey") +
  labs(x = "Chromosomes", y = "Gene Count", title = "Number of genes in each chromosome") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


```{r}
#b
new_values <- c(
  248956422, 242193529, 198295559, 190214555, 181538259, 170805979, 159345973, 145138636,138394717, 133797422,
  135086622, 133275309, 114364328, 107043718, 101991189, 90338345, 83257441, 80373285, 58617616, 64444167, 46709983, 50818468, 156040895,
  57227415)
chromosome_data$Length_C <- new_values
chromosome_data
model <- lm(Gene_Count ~ Length_C,  data = chromosome_data)
summary(model)
correlation <- cor(chromosome_data$Gene_Count, chromosome_data$Length_C)
correlation
ggplot(chromosome_data, aes(x = as.numeric(gsub(",", "", Length_C)), y = Gene_Count)) +
  geom_point() +  # Scatter plot of the data points
  geom_smooth(method = "lm", formula = y ~ x, se = FALSE, color = "blue") +  # Fitted regression line
  labs(x = "Length of Chromosome", y = "Gene Count", title = "Fitted Regression Line") +
  theme_minimal()
fitted_values <- predict(model, newdata = chromosome_data)
fitted_values
ggplot(chromosome_data, aes(x=Length_C, y=Gene_Count)) + 
  geom_point(color='#2980B9', size = 4) + 
  geom_smooth(method=lm, color='#2C3E50')+labs(x = "Length of Chromosome", y = "Gene Count", title = "Fitted Regression Line")
```


```{r}
#c
get_chromosome <- function(data, type = "highest") {
  if (type == "highest") {
    return(data$Chromosome[which.max(data$Gene_Count)])
  } else if (type == "lowest") {
    return(data$Chromosome[which.min(data$Gene_Count)])
  } else {
    stop("Invalid type argument. Please use 'highest' or 'lowest'.")
  }
}

highest_count_chromosome <- get_chromosome(chromosome_data, "highest")
lowest_count_chromosome <- get_chromosome(chromosome_data, "lowest")

cat("Chromosome with the highest count:", highest_count_chromosome, "\n")
cat("Chromosome with the lowest count:", lowest_count_chromosome, "\n")
```


```{r}

```

